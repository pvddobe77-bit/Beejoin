local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local player = Players.LocalPlayer

-- GUI principal
local gui = Instance.new("ScreenGui")
gui.Name = "MenuFlutuante"
gui.Parent = player:WaitForChild("PlayerGui")

-- Botão flutuante preto com "A" branco
local botaoMenu = Instance.new("TextButton")
botaoMenu.Size = UDim2.new(0,60,0,60)
botaoMenu.Position = UDim2.new(0,20,0,30)
botaoMenu.Text = "A"
botaoMenu.Font = Enum.Font.GothamBold
botaoMenu.TextSize = 28
botaoMenu.TextColor3 = Color3.fromRGB(255,255,255)
botaoMenu.BackgroundColor3 = Color3.fromRGB(15,15,15)
botaoMenu.AutoButtonColor = true
botaoMenu.Parent = gui

local uicorner = Instance.new("UICorner")
uicorner.CornerRadius = UDim.new(0,30)
uicorner.Parent = botaoMenu

-- Botão arrastável
local dragging, dragInput, mousePos, framePos = false, nil, nil, nil

local function update(input)
    local delta = input.Position - mousePos
    botaoMenu.Position = UDim2.new(0, framePos.X + delta.X, 0, framePos.Y + delta.Y)
end

botaoMenu.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        mousePos = input.Position
        framePos = botaoMenu.Position

        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

botaoMenu.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

-- Aba Auto Joiner
local autoJoinerFrame = Instance.new("Frame")
autoJoinerFrame.Size = UDim2.new(0,240,0,100) -- maior para dois botões
autoJoinerFrame.Position = UDim2.new(0,20,0,100)
autoJoinerFrame.BackgroundColor3 = Color3.fromRGB(40,40,40)
autoJoinerFrame.Visible = false
autoJoinerFrame.Parent = gui

local frameCorner = Instance.new("UICorner")
frameCorner.CornerRadius = UDim.new(0,12)
frameCorner.Parent = autoJoinerFrame

-- Texto de status
local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(0,220,0,20)
statusLabel.Position = UDim2.new(0,10,0,60)
statusLabel.BackgroundTransparency = 1
statusLabel.TextColor3 = Color3.fromRGB(0,255,0)
statusLabel.Text = ""
statusLabel.Font = Enum.Font.GothamBold
statusLabel.TextSize = 12
statusLabel.Parent = autoJoinerFrame

-- Botão Auto Join God (ANTES era Secret)
local autoJoinerGodBtn = Instance.new("TextButton")
autoJoinerGodBtn.Size = UDim2.new(0,100,0,30)
autoJoinerGodBtn.Position = UDim2.new(0,10,0,20)
autoJoinerGodBtn.Text = "Auto Join God"
autoJoinerGodBtn.BackgroundColor3 = Color3.fromRGB(80,80,80)
autoJoinerGodBtn.TextColor3 = Color3.new(1,1,1)
autoJoinerGodBtn.Parent = autoJoinerFrame

local btnCorner1 = Instance.new("UICorner")
btnCorner1.CornerRadius = UDim.new(0,6)
btnCorner1.Parent = autoJoinerGodBtn

-- Botão Auto Join Secret (ANTES era God)
local autoJoinerSecretBtn = Instance.new("TextButton")
autoJoinerSecretBtn.Size = UDim2.new(0,100,0,30)
autoJoinerSecretBtn.Position = UDim2.new(0,130,0,20)
autoJoinerSecretBtn.Text = "Auto Join Secret"
autoJoinerSecretBtn.BackgroundColor3 = Color3.fromRGB(80,80,80)
autoJoinerSecretBtn.TextColor3 = Color3.new(1,1,1)
autoJoinerSecretBtn.Parent = autoJoinerFrame

local btnCorner2 = Instance.new("UICorner")
btnCorner2.CornerRadius = UDim.new(0,6)
btnCorner2.Parent = autoJoinerSecretBtn

-- Toggle da aba
botaoMenu.MouseButton1Click:Connect(function()
    autoJoinerFrame.Visible = not autoJoinerFrame.Visible
end)

-- Função genérica de Auto Join
local function startAutoJoin(btn, label, searchName)
    local active = false
    local maxAttempts = 15
    local attemptCount = 0

    btn.MouseButton1Click:Connect(function()
        active = not active

        if active then
            btn.Text = "Parar "..searchName
            spawn(function()
                attemptCount = 0
                while active do
                    label.Text = "Procurando "..searchName
                    label.TextSize = 12
                    label.TextColor3 = Color3.fromRGB(0,255,0)
                    local PlaceId = game.PlaceId
                    local servers = {}
                    
                    local success, req = pcall(function()
                        return game:HttpGet("https://games.roblox.com/v1/games/"..PlaceId.."/servers/Public?sortOrder=Asc&limit=100")
                    end)
                    
                    if success then
                        local data = HttpService:JSONDecode(req)
                        for _,v in pairs(data.data) do  
                            if v.id ~= game.JobId and v.playing < v.maxPlayers then
                                table.insert(servers, v)
                            end
                        end  
                    end

                    table.sort(servers, function(a,b)
                        return a.playing > b.playing
                    end)

                    if #servers > 0 then
                        local largestServer = servers[1]
                        label.Text = "Serve full"
                        label.TextSize = 16
                        wait(1)
                        TeleportService:TeleportToPlaceInstance(PlaceId, largestServer.id, player)
                    else
                        attemptCount = attemptCount + 1
                        if attemptCount >= maxAttempts then
                            active = false
                            btn.Text = searchName
                            label.Text = "Nenhum "..searchName.." encontrado, aguarde alguns minutinhos..."
                            label.TextSize = 12
                            label.TextColor3 = Color3.fromRGB(0,255,0)

                            delay(60, function()
                                label.Text = searchName.." encontrado, clique no botão acima"
                                label.TextSize = 12
                                label.TextColor3 = Color3.fromRGB(0,255,0)
                            end)
                            break
                        else
                            label.Text = "Procurando "..searchName
                            label.TextSize = 12
                            wait(2)
                        end
                    end
                end
            end)
        else
            btn.Text = searchName
            label.Text = ""
        end
    end)
end

-- Ativando as funções para cada botão (agora invertidos)
startAutoJoin(autoJoinerGodBtn, statusLabel, "God")
startAutoJoin(autoJoinerSecretBtn, statusLabel, "Secret")
        
